# Example configuration using Azure Key Vault

# Secret Management Configuration
secrets:
  provider: azure
  azure:
    vault_url: "https://mykeyvault.vault.azure.net/"
    
    # Option 1: Use Managed Identity (recommended for Azure VMs/App Services)
    # No credentials needed - uses system or user-assigned managed identity
    
    # Option 2: Use Service Principal
    # tenant_id: "your-tenant-id"
    # client_id: "your-client-id"
    # client_secret: "your-client-secret"
    
    cache_ttl_seconds: 300  # Cache secrets for 5 minutes
  rotation_strategy: "manual"
  rotation_interval_days: 90
  enable_least_privilege: true

# Source API with secret references
source:
  type: rest
  base_url: "https://api.source.com"
  auth:
    type: api_key
    # Reference a secret stored in Azure Key Vault
    key: "secret://source-api-key"
    header: "X-API-Key"
  endpoints:
    list:
      path: "/v1/items"
      method: "GET"

# Target API with secret references
target:
  type: rest
  base_url: "https://api.target.com"
  auth:
    type: bearer
    # Reference a secret with tags for organization
    token: "secret://target-bearer-token"
  endpoints:
    create:
      path: "/v1/items"
      method: "POST"

# Field Mapping
mapping:
  source: list
  target: create
  fields:
    - source_field: id
      target_field: external_id
    - source_field: name
      target_field: title

# Azure RBAC Permissions Required (assign to your managed identity):
# - Key Vault Secrets User (Azure built-in role)
# OR custom role with these permissions:
# - Microsoft.KeyVault/vaults/secrets/getSecret/action
# - Microsoft.KeyVault/vaults/secrets/readMetadata/action
#
# Scope: /subscriptions/{subscription-id}/resourceGroups/{rg}/providers/Microsoft.KeyVault/vaults/{vault-name}
