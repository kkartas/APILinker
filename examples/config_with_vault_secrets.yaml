# Example configuration using HashiCorp Vault for secret management

# Secret Management Configuration
secrets:
  provider: vault
  vault:
    url: "http://localhost:8200"
    # Token authentication
    token: "hvs.CAESI..."  # Vault token
    # OR AppRole authentication
    # role_id: "your-role-id"
    # secret_id: "your-secret-id"
    mount_point: "secret"  # KV mount point
    kv_version: 2  # KV secrets engine version
    namespace: null  # Vault namespace (Enterprise only)
    verify_tls: true  # Verify TLS certificates
    cache_ttl_seconds: 300  # Cache secrets for 5 minutes
  rotation_strategy: "manual"  # manual, scheduled, on_demand, auto
  rotation_interval_days: 90
  enable_least_privilege: true

# Source API with secret references
source:
  type: rest
  base_url: "https://api.source.com"
  auth:
    type: api_key
    # Reference a secret stored in Vault at path "apilinker/source-api-key"
    key: "secret://apilinker/source-api-key"
    header: "X-API-Key"
  endpoints:
    list:
      path: "/v1/items"
      method: "GET"

# Target API with secret references
target:
  type: rest
  base_url: "https://api.target.com"
  auth:
    type: bearer
    # Reference a secret with specific version
    token:
      secret: "apilinker/target-token"
      version: "1"  # Optional: use specific version
  endpoints:
    create:
      path: "/v1/items"
      method: "POST"

# Field Mapping
mapping:
  source: list
  target: create
  fields:
    - source_field: id
      target_field: external_id
    - source_field: name
      target_field: title
    - source_field: description
      target_field: body

# Observability
observability:
  enabled: true
  service_name: "apilinker-vault-demo"
  enable_tracing: true
  enable_metrics: true
  export_to_prometheus: true
  prometheus_port: 9090
